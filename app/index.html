<!DOCTYPE html>
<html>
<head>
	<title>
	</title>
</head>
<body>
	<div class="container">
		<div class="target">
			<div id="action_builder">
				<textarea id="action" style="height:200px;width:200px;">
					function(){
						alert('Pagal');
					}
				</textarea>
			</div>
			<button type="button" id="btn_add_action">
				Add Action
			</button>
			
			<button type="button" id="btn_start_automation">
				Start Automation
			</button>
		</div>
	</div>
	<script src="js/jquery-1.9.1.min.js" type="text/javascript"></script>
	<script src="js/copter.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(function(){
			var actionBuilder = $("#action_builder"), btnAddAction = $("#btn_add_action"), btnStartAutomation = $("#btn_start_automation"), steps = [];
			btnAddAction.on("click",function(e){
				var textArea = document.getElementById("action");
				if(textArea){
					if(textArea.value.indexOf("function") < 0){
						alert("You need to provide a function like shown in the example below.\n\n function(){\n//body goes here...\n}")
						return false;
					}

					steps.push(textArea.value);
					console.log(steps);
				}
			});

			btnStartAutomation.on("click",function(e){
				if (steps.length) {
				var i = 0;
					if(i < steps.length){
						setInterval(function(){ automate(i); i++;}, 2000);
					}
				}
			});
			function automate(index){
				if(index >= steps.length){
					return;
				}
				steps[index] && eval("("+steps[index]+")")();
			}

			$(".target").copter({
				name: "Copter v1"
			});
		});
	</script>
</body>
</html>